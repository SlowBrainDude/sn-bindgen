<html><head><title>SN bindgen: Quick start</title><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.5.0/build/styles/androidstudio.min.css" /><script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.5.0/build/highlight.min.js"></script><script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.5.0/build/languages/scala.min.js"></script><script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.5.0/build/languages/c.min.js"></script><script>hljs.initHighlightingOnLoad();</script><link rel="stylesheet" href="/assets/styles.css" /><link rel="stylesheet" href="/assets/template.css" /><script src="/assets/search.js"></script><script src="/assets/search-index.js"></script><link rel="stylesheet" href="/assets/subatomic-search.css" /><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /></head><body><div class="container"><header class="main-header"><div class="site-title"><h1><a href="/">SN bindgen</a></h1><small>Scala 3 Native binding generator to C libraries</small></div><div id="searchContainer" class="searchContainer"></div><div class="site-links"><a href="https://github.com/indoorvivants/sn-bindgen"><img src="https://cdn.svgporn.com/logos/github-icon.svg" class="gh-logo" /></a></div></header><div><a class="nav-btn" href="/index.html">Home</a><a class="nav-btn" href="/motivation/index.html">Motivation</a><a class="nav-btn" href="/configuration/index.html">Configuration </a><a class="nav-btn" href="/cookbook/index.html">Cookbook</a><a class="nav-btn" href="/limitations/index.html">Limitations</a><a class="nav-btn" href="/semantics/index.html">Semantics </a><a class="nav-btn nav-selected" href="/quickstart/index.html">Quick start</a></div><hr /><div><!--toc:start-->
<ul>
<li><a href="#pre-requisites">Pre-requisites</a></li>
<li><a href="#supported-platforms">Supported platforms</a></li>
<li><a href="#installation-with-sbt">Installation with SBT</a></li>
</ul>
<!--toc:end-->
<p>Quickest way to start would be to use the <a href="https://github.com/keynmol/sn-bindgen-template/">template</a>.</p>
<p>For more involved examples, see a <a href="https://github.com/keynmol/sn-bindgen-examples/">dedicated repository</a></p>
<h2><a href="#pre-requisites" id="pre-requisites">Pre-requisites</a></h2>
<p>The bindgen's binary is dynamically linked against Clang 14.</p>
<p>Therefore you must have it installed on the system that <em>generates</em> the code, you can follow <a href="https://scala-native.readthedocs.io/en/latest/user/setup.html#installing-clang-and-runtime-dependencies">Scala Native's instructions</a>.</p>
<p>Code generated by bindgen has no runtime dependencies on bindgen, LLVM, or Clang.</p>
<h2><a href="#supported-platforms" id="supported-platforms">Supported platforms</a></h2>
<table class = 'compatibility'>
<tr><th>OS</th><th>Architecture</th><th>Tested on CI</th><th>Binary published</th><th>Comments</th></tr>
<tr>
<td>Linux</td>
<td>x64</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>Mac OS X</td>
<td>x64</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>Windows</td>
<td>x64</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>Mac OS X</td>
<td>M1 (arm64)</td>
<td>❌</td>
<td>❌</td>
<td>Works well, M1 is where I develop this project</td>
</tr>
<tr>
<td>Linux</td>
<td>arm64</td>
<td>❌</td>
<td>❌</td>
<td>Anecdotal evidence that it works, I run tests in an arm64 VM sometimes</td>
</tr>
<tr>
<td>Windows</td>
<td>arm64</td>
<td>❌</td>
<td>❌</td>
<td>Anecdotal evidence that it works, I run tests in an arm64 VM sometimes</td>
</tr>
</table>
<h2><a href="#installation-with-sbt" id="installation-with-sbt">Installation with SBT</a></h2>
<p><strong>project/plugins.sbt</strong></p>
<pre><code class="language-scala">// only add this line if you're living on the edge and using 
// a version that has &quot;SNAPSHOT&quot; in it
resolvers += Resolver.sonatypeRepo(&quot;snapshots&quot;)

addSbtPlugin(&quot;com.indoorvivants&quot; % &quot;bindgen-sbt-plugin&quot; % &quot;0.0.15+2-3cd83498-SNAPSHOT&quot;)
</code></pre>
<p><strong>build.sbt</strong></p>
<pre><code class="language-scala">// only add this line if you're living on the edge and using 
// a version that has &quot;SNAPSHOT&quot; in it
resolvers += Resolver.sonatypeRepo(&quot;snapshots&quot;)
scalaVersion := &quot;3.1.1&quot;

enablePlugins(ScalaNativePlugin, BindgenPlugin)

import bindgen.interface.Binding

bindgenBindings := Seq(
  Binding(
  /* 1 */  baseDirectory.value / &quot;src&quot; / &quot;main&quot; / &quot;resources&quot; / &quot;scala-native&quot; / &quot;header.h&quot;,
  /* 2 */  &quot;libtest&quot;,
  /* 3 */  cImports = List(&quot;header.h&quot;)
  )
)
</code></pre>
<ol>
<li>Path to the header file - in this example we're putting it into a location
recognised by Scala Native's SBT plugin, any sources there will be linked alongside
the Scala sources</li>
<li>Package name where generated definitions will be put</li>
<li>List of imports that will be added to generated C files (if there are any, see <a href="/semantics">Semantics</a> page for details)</li>
</ol>
<p>There are more settings available, see <a href="/configuration#sbt-plugin">Configuration</a> page for details.</p>
<p>Now all that is left to do is put some definitions into the header file:</p>
<div style = "display:flex;width:100%; font-size:16px; justify-content: space-between;"><div style = "width: 40%; text-align: left"><b>src/main/resources/scala-native/header.h</b><pre><code class = "hljs language-c"><br />    typedef enum { X = 1, Y = 2} bla;<br />    void sum(bla one, bla two);<br />    </pre></code></div><div style = "width:55%"><div style = "overflow: scroll;"><b>Generated Scala</b><div style = "max-height:400px"><pre><code class = "hljs language-scala">package libtest<br><br>import _root_.scala.scalanative.unsafe.*<br>import _root_.scala.scalanative.unsigned.*<br>import _root_.scala.scalanative.libc.*<br>import _root_.scala.scalanative.*<br><br>object predef:<br>  private[libtest] trait CEnumU[T](using eq: T =:= UInt):<br>    given Tag[T] = Tag.UInt.asInstanceOf[Tag[T]]<br>    extension (inline t: T)<br>     inline def int: CInt = eq.apply(t).toInt<br>     inline def uint: CUnsignedInt = eq.apply(t)<br>     inline def value: CUnsignedInt = eq.apply(t)<br><br><br>object enumerations:<br>  import predef.*<br>  opaque type bla = CUnsignedInt<br>  object bla extends CEnumU[bla]:<br>    given _tag: Tag[bla] = Tag.UInt<br>    inline def define(inline a: Long): bla = a.toUInt<br>    val X = define(1)<br>    val Y = define(2)<br>    inline def getName(inline value: bla): Option[String] =<br>      value match<br>        case X => Some("X")<br>        case Y => Some("Y")<br>        case _ => None<br>    extension (a: bla)<br>      inline def &(b: bla): bla = a & b<br>      inline def |(b: bla): bla = a | b<br>      inline def is(b: bla): Boolean = (a & b) == b<br><br><br>@extern<br>private[libtest] object extern_functions:<br>  import _root_.libtest.enumerations.*<br><br>  def sum(one : bla, two : bla): Unit = extern<br><br><br>object functions:<br>  import _root_.libtest.enumerations.*<br><br>  import extern_functions.*<br>  export extern_functions.*<br><br>object types:<br>  export _root_.libtest.enumerations.*<br></code></pre></div></div></div></div>
<p>After that in your Scala sources you can use <code>libtest</code> package to access the
generated bindings.</p>
</div></div><footer>© 2021-2023 Anton Sviridov</footer><script src="https://www.googletagmanager.com/gtag/js?id=G-2V7BY56Z37"></script><script> window.dataLayer = window.dataLayer || [];
              function gtag(){window.dataLayer.push(arguments);}
              gtag('js', new Date());

              gtag('config', 'G-2V7BY56Z37');</script></body></html>